<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.bread.app.OrderMapper">
	<!-- Create -->
		
	<!-- Read -->
	<!-- 오더 내용 -->
	<select id="order" parameterType="pageVO" resultType="orderVO">
		select payment_status, order_idx, payment_date, member_idx, amount
			from bc_order
			where member_idx = #{member_idx}
			order by payment_date desc
	</select>	
	<!-- 아이템 내용 -->
	<select id="item" parameterType="pageVO" resultType="itemVO">
		select o.order_idx, o.member_idx, b.bread_idx,
				b.bread_img_save, b.bread_name, b.bread_price, i.bread_count,
				bk.bakery_name, i.review_status, bk.bakery_idx
			from bc_order o 
				 left outer join bc_item i on o.order_idx = i.order_idx 
				 left outer join bc_bread b on i.bread_idx = b.bread_idx
				 left outer join bc_bakery bk on i.bakery_idx = bk.bakery_idx
			where o.member_idx = #{member_idx}
			and o.order_idx = #{order_idx}
			order by payment_date desc
			limit #{startIdx}, 10
	</select>

		<!-- 개인 주문 내역의 총 갯수 조회 -->
	<select id="getTotalCount" parameterType="pageVO" resultType="_int">
		select count(*)
			from bc_order o 
				 left outer join bc_item i on o.order_idx = i.order_idx 
				 left outer join bc_bread b on i.bread_idx = b.bread_idx
				 left outer join bc_bakery bk on i.bakery_idx = bk.bakery_idx
			where o.member_idx = #{member_idx}
			and o.order_idx = #{order_idx}
			order by payment_date desc
	</select>

	<!-- Update -->	
	<!-- Delete -->
</mapper>